---
title: Qtå°è£…ä¸€ä¸ªç®€å•çš„LED(æŒ‡ç¤ºç¯)æ§ä»¶
date: 2021-12-21 15:15:29
tags: [qt,widget]
---
### æ•ˆæœ~
![](https://pic.imgdb.cn/item/61c18ecc2ab3f51d9182065d.gif)

- æ‰€ä»¥  
- è¿™ä¸ªç®€å•çš„LEDç±»å¯ä»¥è‡ªå®šä¹‰å¤§å°~  
- å¯ä»¥ç‚¹äº®æˆ–ç†„ç­ï¼Œä¹Ÿå¯ä»¥é—ªçƒğŸ‘ï¸~  
- é—ªçƒçš„æ—¶é—´é—´éš”âŒ›å¯è‡ªå®šä¹‰ï¼Œåªéœ€è¦åœ¨è®¾ç½®é—ªçƒçŠ¶æ€å‰è°ƒç”¨ç±»çš„setInterval(msec)å‡½æ•°~  
- æœ‰å‡ ç§é¢„å®šä¹‰çš„é¢œè‰²ï¼ˆçº¢ğŸ”´ã€ç»¿ğŸŸ¢ã€è“ğŸ”µã€é»„ğŸŸ¡å’Œæ©˜è‰²ğŸŸ ï¼‰,ä¹Ÿæä¾›è‡ªå®šä¹‰é¢œè‰²çš„å‡½æ•°~  
- å¦‚æœè¿˜æ»¡è¶³ä¸äº†éœ€è¦ï¼Œå°±å¾—è‡ªå·±æ‰©å±•ğŸ§‘â€ğŸ”§äº†ï¼Œç±»å¾ˆå°ï¼Œè¿™ä¹Ÿå¾ˆæ–¹ä¾¿~  
- å·¥ç¨‹æ–‡ä»¶ä¸­æœ‰è¿™ä¸ªä¾‹å­ä»£ç ï¼Œå¯ä»¥å½“ä½œç”¨æ³•å…¥é—¨ï¼Œå…¶å®åªæ˜¯å¼•å…¥å¤´æ–‡ä»¶ï¼Œå®šä¹‰ç±»å¯¹è±¡ï¼Œç„¶åå½“ä¸€ä¸ªæ™®é€šæ§ä»¶(å¦‚ï¼šQPushButton)æ¥ç”¨~  
- æœ€ç®€å•çš„æ–¹æ³•æ˜¯æŠŠç±»æ–‡ä»¶QSimpleLed.hå’ŒQSimpleLed.cppæ‹·åˆ°è‡ªå·±å·¥ç¨‹é‡Œï¼Œç„¶ååœ¨éœ€è¦ä½¿ç”¨çš„æ–‡ä»¶é‡ŒåŒ…- å«ã€‚ç±»ä»£ç å¯¹Qtç‰ˆæœ¬æ²¡æœ‰ç‰¹åˆ«è¦æ±‚~  
- å·®ä¸å¤šäº†ï¼Œæœ‰äº†ä¸Šé¢è¿™å‡ ç‚¹æç¤ºï¼Œä»ä¸‹é¢ä¸‹è½½æ–‡ä»¶try tryğŸ’ªğŸ’ªğŸ’ªï¼Œå¦‚æœè¿˜æœ‰å…¶å®ƒé—®é¢˜ï¼Œæ¬¢è¿åœ¨ä¸‹é¢ç•™ä¸ªè¯„è®º~  
- å¦å¤–ä¸‹é¢ç¬¬ä¸‰éƒ¨åˆ†æ˜¯å®ç°è¿‡ç¨‹ä¸­çš„ä¸€äº›è¦ç‚¹~  

### èµ„æºæ–‡ä»¶
- ä¸‹è½½é“¾æ¥ï¼šé“¾æ¥ï¼šhttps://share.weiyun.com/5HK0503W å¯†ç ï¼šrxdmyk  
 
![å·¥ç¨‹æ–‡ä»¶ç»“æ„ ](https://pic.imgdb.cn/item/61c18ecc2ab3f51d91820660.png)

- `QtSimpleLed.h`å’Œ`QtSimpleLed.cpp`æ˜¯å°è£…çš„LEDç±»  
- `mainwindow.h`å’Œ`mainwindow.cpp`é‡Œé¢æœ‰ä¾‹å­  
- å…¶å®ƒæ˜¯Qtå»ºå·¥ç¨‹æ—¶è‡ªå·±ç”Ÿæˆçš„ã€‚  

### å…³äºä¾‹å­

```cpp
    QTimer::singleShot(200/7.0*1, nullptr, [&]() {
        stepLed01->setStates(QSimpleLed::BLINK);
    });
```

- ä¸Šé¢çš„ä»£ç æ˜¯ä¾‹å­ä¸­è®¾ç½®LEDé—ªçƒçš„ï¼Œç”¨äº†lamda(C++11å¼•å…¥)ï¼Œç¬¬ä¸€æ¬¡æ¥è§¦å¯ä»¥ä¸å¤ªæ‡‚ï¼Œæ„æ€æ˜¯ï¼š
- `200/7.0*1`ç§’åæ‰§è¡Œä¸€ä¸‹è¿™ä¸ªä»£ç å—`{ stepLed01->setStates(QSimpleLed::BLINK); }`
- ç”¨ä¼ ç»Ÿå†™æ³•ï¼š

```cpp
// å®šä¹‰ä¸€ä¸ªå®šæ—¶å™¨
// å°†å®šæ—¶å™¨è®¾ç½®æˆä¸€æ¬¡è§¦å‘(singleShot)ç±»å‹
// å®šä¹‰ä¸€ä¸ªsloté‡Œé¢æ˜¯ stepLed01->setStates(QSimpleLed::BLINK);
// è¿æ¥å®šæ—¶å™¨çš„timeoutä¿¡å·å’Œè¿™ä¸ªslot
// è°ƒç”¨start()å¯åŠ¨å®šæ—¶å™¨
```

- æ‰€ä»¥è¿™æ ·æ­¥éª¤æ¯”è¾ƒç¹çï¼Œç¬¬ä¸€æ¬¡æ¥è§¦å¯ä»¥çœ‹çœ‹C++ lamdaçš„è¯­æ³•ï¼Œç”¨èµ·æ¥éå¸¸å®¹æ˜“ï¼Œæ¯•ç«Ÿæ€»æ˜¯å…ˆæœ‰äº†ç¬¬ä¸€æ¬¡æ‰ä¼šæœ‰ç¬¬äºŒæ¬¡~ğŸ™‚

### å®ç°è¿‡ç¨‹å…³é”®ç‚¹â€¦

- è¿™åœ°å†™å®ç°è¿‡ç¨‹ä¸­çš„ä¸€äº›æƒ³æ³•ã€‚  
- æ•´ä½“æ€è·¯æ˜¯ç»§æ‰¿`QAbstractButton`ç±»ç„¶åå®ç°å…¶é‡ç»˜(`paintEvent()`)è™šå‡½æ•°ï¼Œæœ€åç»˜åˆ¶æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼š
![](https://pic.imgdb.cn/item/61c18ecc2ab3f51d91820668.png)
- ä¸‹é¢çš„é—®é¢˜æ˜¯æ€æ ·å®ç°LEDæ‰€è¡¨ç°å‡ºæ¥çš„æ•ˆæœäº†:
- è¿™é‡Œä¸»è¦ç”¨åˆ°äº†é¢œè‰²æ¸å˜æ•ˆæœï¼Œè¿™ç‚¹æˆ‘åœ¨ä¹‹å‰çš„ä¸€ä¸ªblogä¸­è¯´çš„è¶³å¤Ÿå¤šï¼š[ä¸€æ–‡ææ‡‚Qté¢œè‰²æ¸å˜](https://blog.csdn.net/weixin_37818081/article/details/118879134 )
- è¿™é‡Œç”¨çš„æ˜¯å¾„å‘æ¸å˜ï¼Œä¹Ÿéå¸¸å®¹æ˜“æƒ³è±¡å‡ºæ¥ï¼Œçœ‹ä¸‹å›¾ç†è§£:
![](https://pic.imgdb.cn/item/61c194a52ab3f51d91850adf.png)
- æ‰€ä»¥åœ¨ç±»ä¸­å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä»£ç ï¼š

```cpp
    //
    // gradient - 1
    radialGent = QRadialGradient(QPointF(-500, -500)
                                 , 1500
                                 , QPointF(-500, -500));
    radialGent.setColorAt(0, QColor(224, 224, 224));
    radialGent.setColorAt(1, QColor(28, 28, 28));
	
    // ...

    //
    // gradient - 2
    radialGent = QRadialGradient(QPointF(500, 500)
                                 , 1500
                                 , QPointF(500, 500));
    radialGent.setColorAt(0, QColor(224, 224, 224));
    radialGent.setColorAt(1, QColor(28, 28, 28));
	
    // ...
    
    if (isChecked()) {
        //
        // gradient - on
        radialGent = QRadialGradient(QPointF(-500, -500)
                                     , 1500
                                     , QPointF(-500, -500));
        radialGent.setColorAt(0, smColorPalette[mColor].on0);
        radialGent.setColorAt(1, smColorPalette[mColor].on1);

    } else {
        //
        // gradient - off
        radialGent = QRadialGradient(QPointF(500, 500)
                                     , 1500
                                     , QPointF(500, 500));
        radialGent.setColorAt(0, smColorPalette[mColor].off0);
        radialGent.setColorAt(1, smColorPalette[mColor].off1);
    }
	...
```

- æœ€åä¸€ä¸ªé—®é¢˜ï¼Œåœ¨é‡ç»˜å‡½æ•°ä¸­ä½¿ç”¨äº†ä¸‹é¢è¿™ç§ç»˜åˆ¶æ–¹å¼ï¼š

```cpp
	...
    painter.setRenderHint(QPainter::Antialiasing);      
    painter.translate(width()/2, height()/2);           
    painter.scale(realSize/1000, realSize/1000);  // è¿™é‡Œå¯¹åæ ‡ç³»ç»Ÿè¿›è¡Œç¼©æ”¾ï¼ï¼ï¼
    painter.setBrush(QBrush(radialGent));
    painter.drawEllipse(QPointF(0, 0), 500, 500);
    ...
```

- æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæƒ³ç»˜åˆ¶ä¸€ä¸ªå†…åˆ‡äºæ§ä»¶çš„åœ†å½¢ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè¿™æ ·ï¼š

```cpp
 	painter.drawEllipse(QPointF(0, 0), realSize/2, realSize/2);
```

- å…¶ä¸­realSizeæ˜¯å½“å‰æ§ä»¶çš„å®é™…å¤§å°(è¾ƒå°çš„ä¸€è¾¹)ï¼Œæˆ‘ä»¬ç”¨å®ƒçš„ä¸€åŠä½œä¸ºåŠå¾„æ¥ç»˜åˆ¶åœ†ï¼Œå½¢æˆå†…åˆ‡ã€‚
- ä½†ç°åœ¨å–è€Œä»£ä¹‹çš„æ˜¯ä¸‹é¢è¿™ä¸¤å¥ï¼š

```cpp
    painter.scale(realSize/1000, realSize/1000);  
    ...
    painter.drawEllipse(QPointF(0, 0), 500, 500);
```

- è¿™åŒæ ·å®ç°äº†ç»˜åˆ¶å†…åˆ‡åœ†ã€‚  
- æˆ‘ä»¬å®é™…ä¸Šæ˜¯æ¢äº†ä¸€ä¸ªæ€è€ƒè§’åº¦ï¼Œä¹‹å‰ç»˜åˆ¶æ—¶ï¼Œæˆ‘ä»¬æ€»æ˜¯æŠŠåæ ‡ç³»å½“åšåŸºå‡†ï¼Œæˆ‘ä»¬æ‰€ç”»çš„å›¾å½¢éƒ½æ¥é€‚åº”å·²å­˜åœ¨çš„åæ ‡ç³»ï¼Œç°åœ¨æˆ‘ä»¬ç”¨æ§ä»¶çš„å®é™…å¤§å°æ¥å½±å“åæ ‡ç³»çš„æ„é€ ï¼Œå½“æˆ‘ä»¬ç»˜åˆ¶ä¸€ä¸ªå¤§å°ä¸º`(500, 500)`çš„åœ†å½¢æ—¶ï¼Œåœ¨ç”¨å›¾å½¢å¤§å°(`realSize`)æ„é€ çš„è¿™ä¸ªåæ ‡ç³»å†…ï¼Œå®ƒçš„å®é™…å¤§å°æ˜¯`realSize/1000 * 500`ï¼Œä¹Ÿå°±æ˜¯`1/2 * realSize`ï¼Œè¿™æ­£æ˜¯å›¾å½¢å®é™…å¤§å°çš„ä¸€åŠã€‚  
- è¿™æ ·"åå®¢ä¸ºä¸»â€œçš„æ–¹å¼ä¹Ÿçš„ç¡®è®©æˆ‘ä»¬æœ‰äº†ç»˜åˆ¶çš„ä¸»åŠ¨æƒï¼Œå¦åˆ™æˆ‘ä»¬æ‰€æœ‰ä¸åæ ‡æœ‰å…³çš„ä»£ç ä¸­éƒ½å¾—å¼•ç”¨realSizeï¼Œå®¹æ˜“å‡ºé”™ä¹Ÿä¸æ˜“è¯»ã€‚  
- ä¸ºä»€ä¹ˆé™¤1000ï¼Ÿå…¶å®è¿™å¹¶ä¸æ˜¯é‡ç‚¹ï¼Œåªæ˜¯1000çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªå•ä½ï¼Œå…³é”®çš„ä¸€ç‚¹æ˜¯æˆ‘ä»¬çš„ç¡®ç”¨realSizeå½±å“äº†åæ ‡ç³»çš„æ„é€ ï¼Œä¹Ÿå°±æ˜¯è¿™å¥:  

```cpp
	painter.scale(realSize/1000, realSize/1000); 
```

- åœ¨æ­¤åæ ‡ç³»ä¸‹ï¼Œæˆ‘ä»¬ç»˜åˆ¶é•¿åº¦1000çš„ç›´çº¿ï¼Œå…¶å®å…¶é•¿åº¦åªæœ‰realSizeå¤§å°ï¼Œæ­¤æ—¶æˆ‘ä»¬å…³æ³¨æ›´å¤šçš„æ˜¯æ¯”ä¾‹ï¼Œè€Œä¸æ˜¯å…·ä½“çš„åæ ‡å€¼â€¦  
### å‚è€ƒ
- [ä¸€ä¸ªå¾ˆæ£’çš„é…è‰²ç½‘ç«™](https://www.schemecolor.com/)
- [https://github.com/colinbourassa/rovergauge/](https://github.com/colinbourassa/rovergauge/)
